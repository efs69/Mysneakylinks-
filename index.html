<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Sneakylinks â€” Devices & Hostels</title>
  <meta name="description" content="Sneakylinks â€” laptops, phones, gadgets and hostel bookings in one modern, mobile-friendly storefront." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #0b0c10;
      --card: #111218;
      --text: #e6e6e6;
      --muted: #9aa0a6;
      --brand: #4f46e5;
      --brand-2: #06b6d4;
      --border: #22242e;
      --shadow: 0 10px 25px rgba(0,0,0,.25);
    }
    .light{
      --bg: #f6f7fb;
      --card: #ffffff;
      --text: #0b0c10;
      --muted: #5f6368;
      --brand: #4f46e5;
      --brand-2: #06b6d4;
      --border: #e8eaf0;
      --shadow: 0 10px 25px rgba(0,0,0,.08);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:var(--bg);
      color:var(--text);
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      overflow-x:hidden;
    }
    img{max-width:100%;display:block}
    .no-select{-webkit-user-select:none;user-select:none}
    .app{min-height:100%;display:flex;flex-direction:column}
    .topbar{
      position:sticky;top:0;z-index:20;
      display:flex;align-items:center;justify-content:space-between;
      padding:12px 16px;border-bottom:1px solid var(--border);
      backdrop-filter:saturate(180%) blur(8px);background:color-mix(in oklab, var(--bg) 85%, transparent);
    }
    .brand{display:flex;align-items:center;gap:10px;font-weight:800;cursor:pointer}
    .logo-dot{width:14px;height:14px;border-radius:50%;background:linear-gradient(135deg,var(--brand),var(--brand-2));box-shadow:0 0 0 3px color-mix(in oklab, var(--brand) 15%, transparent)}
    .brand-text{font-size:1.05rem;letter-spacing:.3px}
    .top-actions{display:flex;align-items:center;gap:10px}
    .btn{
      border:1px solid var(--border);background:var(--card);color:var(--text);
      padding:10px 14px;border-radius:14px;font-weight:600;cursor:pointer;
      box-shadow:var(--shadow);text-decoration:none;display:inline-flex;align-items:center;gap:8px;
    }
    .btn.primary{background:linear-gradient(135deg,var(--brand),var(--brand-2));border:none;color:#fff}
    .btn.ghost{background:transparent}
    .btn:active{transform:translateY(1px)}
    .hero{
      padding:56px 16px 30px;border-bottom:1px solid var(--border);
      background:
        radial-gradient(800px 300px at 20% -10%, color-mix(in oklab, var(--brand) 20%, transparent), transparent),
        radial-gradient(800px 300px at 80% -10%, color-mix(in oklab, var(--brand-2) 18%, transparent), transparent);
    }
    .hero-inner{max-width:1100px;margin:0 auto;text-align:center}
    .hero h1{font-size:clamp(28px,5vw,44px);margin:0 0 8px;font-weight:800}
    .muted{color:var(--muted)}
    .hero-actions{margin-top:18px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
    .container{max-width:1200px;margin:0 auto;padding:22px 16px}
    .section-head{display:flex;align-items:baseline;justify-content:space-between;gap:10px;margin-bottom:10px}
    .section-head h2{margin:0;font-size:clamp(20px,4vw,28px)}
    .grid{display:grid;gap:14px}
    @media (max-width: 639px){ .grid{grid-template-columns: repeat(2, minmax(0,1fr));} }
    @media (min-width: 640px) and (max-width: 959px){ .grid{grid-template-columns: repeat(3, minmax(0,1fr));} }
    @media (min-width: 960px){ .grid{grid-template-columns: repeat(4, minmax(0,1fr));} }
    .card{
      background:var(--card);border:1px solid var(--border);border-radius:18px;padding:12px;
      box-shadow:var(--shadow);
    }
    .product{ display:flex;flex-direction:column;gap:8px;cursor:pointer; }
    .product .thumb{ aspect-ratio:1/1;border-radius:12px;overflow:hidden;background:#0f1014;display:flex;align-items:center;justify-content:center; }
    .product .thumb img{width:100%;height:100%;object-fit:cover}
    .product .title{font-weight:700;font-size:.95rem}
    .product .specs{font-size:.85rem;color:var(--muted);min-height:40px}
    .price{font-weight:800}
    .product .row{display:flex;align-items:center;justify-content:space-between}
    .form{display:grid;gap:12px}
    .form-row{display:grid;gap:6px}
    .form-row input, .form-row textarea, .form-row select{
      padding:10px 12px;border:1px solid var(--border);background:var(--card);border-radius:12px;color:var(--text);
    }
    .form-actions{display:flex;gap:10px;justify-content:flex-end}
    .form-actions.center{justify-content:center}
    .footer{padding:28px 16px;border-top:1px solid var(--border);text-align:center;margin-top:auto}
    .tiny{font-size:.8rem}
    .modal{
      position:fixed;inset:0;background:rgba(0,0,0,.6);
      display:flex;align-items:center;justify-content:center;padding:16px;z-index:50;
    }
    .modal.hidden{display:none}
    .modal-card{
      background:var(--card);border:1px solid var(--border);border-radius:18px;box-shadow:var(--shadow);
      width:min(950px,100%);padding:14px;position:relative;
    }
    .modal-card.narrow{width:min(460px,100%)}
    .modal-body{display:grid;gap:14px}
    .modal-close{
      position:absolute;margin:-8px -8px 0 0;right:20px;top:20px;border:none;background:transparent;color:var(--text);font-size:20px;cursor:pointer;
    }
    .viewer{position:relative;border-radius:14px;overflow:hidden}
    .viewer img{width:100%;height:360px;object-fit:cover;background:#0f1014}
    .carousel-btn{
      position:absolute;top:50%;transform:translateY(-50%);border:none;background:rgba(0,0,0,.4);
      padding:6px 10px;border-radius:10px;color:#fff;font-weight:700;cursor:pointer;
    }
    #prevImg{left:8px} #nextImg{right:8px}
    .view-info{display:grid;gap:8px}
    .price-row{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .admin{
      position:fixed;inset:0;background:rgba(0,0,0,.7);z-index:60;display:grid;
      grid-template-rows:auto 1fr auto;padding:16px;
    }
    .admin.hidden{display:none}
    .admin-header,.admin-footer{
      background:var(--card);border:1px solid var(--border);border-radius:16px;padding:12px;box-shadow:var(--shadow);
      display:flex;align-items:center;justify-content:space-between;gap:12px;
    }
    .admin-body{ display:grid;grid-template-columns:280px 1fr;gap:12px;padding:12px 0; }
    .admin-list{
      background:var(--card);border:1px solid var(--border);border-radius:16px;padding:10px;max-height:60vh;overflow:auto;
    }
    .admin-list .item{
      display:flex;align-items:center;gap:8px;padding:8px;border:1px solid var(--border);border-radius:12px;margin-bottom:8px;cursor:pointer;
    }
    .admin-list .item.active{outline:2px solid var(--brand)}
    .admin-editor{
      background:var(--card);border:1px solid var(--border);border-radius:16px;padding:12px;max-height:60vh;overflow:auto;
    }
    .empty-state{color:var(--muted);text-align:center;margin-top:40px}
    .image-row{display:flex;flex-wrap:wrap;gap:10px}
    .image-cell{width:96px;height:96px;border:1px dashed var(--border);border-radius:12px;display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative;background:#0f1014}
    .image-cell img{width:100%;height:100%;object-fit:cover}
    .handle{position:absolute;bottom:6px;right:6px;font-size:11px;background:rgba(0,0,0,.4);padding:2px 6px;border-radius:8px;color:#fff}
    .delete{position:absolute;top:6px;right:6px;font-size:12px;background:rgba(0,0,0,.6);padding:2px 6px;border-radius:8px;color:#fff;cursor:pointer}
    .dragging{opacity:.6}
    .hidden{display:none}
  </style>
</head>
<body>
  <div id="app" class="app">
    <header class="topbar no-select">
      <div class="brand" id="brandLogo" title="Sneakylinks">
        <span class="logo-dot"></span>
        <span class="brand-text">Sneakylinks</span>
      </div>
      <div class="top-actions">
        <button id="darkToggle" class="btn ghost" aria-label="Toggle color mode" title="Toggle color mode">ðŸŒ“</button>
        <a class="btn primary" href="#request-area">Request a Product</a>
      </div>
    </header>

    <section class="hero">
      <div class="hero-inner">
        <h1>Everything tech. One link.</h1>
        <p class="muted">
          We sell laptops, phones, and gadgets â€” and we book hostels too. Browse, view details, and book via WhatsApp in seconds.
        </p>
        <div class="hero-actions">
          <a href="#products" class="btn primary">Shop Devices</a>
          <a href="#hostels" class="btn">Book Hostels</a>
        </div>
      </div>
    </section>

    <main id="products" class="container">
      <div class="section-head">
        <h2>Featured Devices</h2>
        <p class="muted">Tap a product to view or book. Add and edit everything from the hidden admin mode.</p>
      </div>
      <div id="grid" class="grid"></div>
    </main>

    <section id="hostels" class="container">
      <div class="section-head">
        <h2>Hostel Bookings</h2>
        <p class="muted">Need a place to stay? Tell us your budget and preferred location â€” weâ€™ll handle the rest.</p>
      </div>
      <form id="hostelForm" class="card form">
        <div class="form-row">
          <label>Full Name</label>
          <input type="text" id="hostelName" required placeholder="Your name" />
        </div>
        <div class="form-row">
          <label>Contact</label>
          <input type="tel" id="hostelContact" required placeholder="Phone or WhatsApp" />
        </div>
        <div class="form-row">
          <label>Location Preference</label>
          <input type="text" id="hostelLocation" required placeholder="City/Area" />
        </div>
        <div class="form-row">
          <label>Budget (optional)</label>
          <input type="text" id="hostelBudget" placeholder="e.g., 2,500 GHS/month" />
        </div>
        <div class="form-row">
          <label>Send To</label>
          <select id="waNumberHostel"></select>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn primary">Send Hostel Request via WhatsApp</button>
        </div>
      </form>
    </section>

    <section id="request-area" class="container">
      <div class="section-head">
        <h2>Request a Product</h2>
        <p class="muted">Canâ€™t find what you want? Tell us and weâ€™ll source it for you.</p>
      </div>
      <form id="requestForm" class="card form">
        <div class="form-row">
          <label>Full Name</label>
          <input type="text" id="reqName" required placeholder="Your name" />
        </div>
        <div class="form-row">
          <label>Contact</label>
          <input type="tel" id="reqContact" required placeholder="Phone or WhatsApp" />
        </div>
        <div class="form-row">
          <label>Desired Product</label>
          <input type="text" id="reqProduct" required placeholder="e.g., iPhone 14 Pro 256GB" />
        </div>
        <div class="form-row">
          <label>Notes (optional)</label>
          <textarea id="reqNotes" rows="3" placeholder="Color, condition, price rangeâ€¦"></textarea>
        </div>
        <div class="form-row">
          <label>Send To</label>
          <select id="waNumberRequest"></select>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn primary">Send Request via WhatsApp</button>
        </div>
      </form>
    </section>

    <footer class="footer no-select">
      <p>&copy; <span id="year"></span> Sneakylinks. All rights reserved.</p>
      <p class="tiny muted">Tap the logo 5Ã— for admin login.</p>
    </footer>
  </div>

  <div id="viewModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="viewTitle">
    <div class="modal-card">
      <button class="modal-close" data-close="viewModal" aria-label="Close">âœ•</button>
      <div class="modal-body">
        <div class="viewer">
          <button class="carousel-btn" id="prevImg" aria-label="Previous image">â€¹</button>
          <img id="viewImg" alt="Product image" />
          <button class="carousel-btn" id="nextImg" aria-label="Next image">â€º</button>
        </div>
        <div class="view-info">
          <h3 id="viewTitle"></h3>
          <p id="viewSpecs" class="muted"></p>
          <div class="price-row">
            <span id="viewPrice" class="price"></span>
            <button id="bookBtn" class="btn primary">Book this item</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="bookModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="bookTitle">
    <div class="modal-card narrow">
      <button class="modal-close" data-close="bookModal" aria-label="Close">âœ•</button>
      <div class="modal-body">
        <h3 id="bookTitle">Book Product</h3>
        <form id="bookForm" class="form">
          <div class="form-row">
            <label>Full Name</label>
            <input type="text" id="custName" required placeholder="Your name" />
          </div>
          <div class="form-row">
            <label>Location</label>
            <input type="text" id="custLocation" required placeholder="City/Area" />
          </div>
          <div class="form-row">
            <label>Contact</label>
            <input type="tel" id="custContact" required placeholder="Phone or WhatsApp" />
          </div>
          <div class="form-row">
            <label>Selected Item</label>
            <input type="text" id="custProduct" required readonly />
          </div>
          <div class="form-row">
            <label>Send To</label>
            <select id="waNumberBooking"></select>
          </div>
          <div class="form-actions center">
            <button type="submit" class="btn primary">Send Booking via WhatsApp</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div id="adminLoginModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="adminLoginTitle">
    <div class="modal-card narrow">
      <button class="modal-close" data-close="adminLoginModal" aria-label="Close">âœ•</button>
      <div class="modal-body">
        <h3 id="adminLoginTitle">Admin Login</h3>
        <form id="adminLoginForm" class="form">
          <div class="form-row">
            <label>Password</label>
            <input type="password" id="adminPasswordInput" required placeholder="Enter admin password" />
          </div>
          <div class="form-actions">
            <button class="btn primary" type="submit">Enter Admin</button>
          </div>
          <p class="tiny muted">Default password: <b>admin</b> (change it inside Admin â†’ Settings).</p>
        </form>
      </div>
    </div>
  </div>

  <div id="adminPanel" class="admin hidden">
    <div class="admin-header">
      <h3>Admin â€” Sneakylinks</h3>
      <div class="admin-actions">
        <button id="addProduct" class="btn">+ Add Product</button>
        <button id="saveAll" class="btn primary">Save All</button>
        <button id="exportData" class="btn ghost">Export JSON</button>
        <button id="closeAdmin" class="btn ghost">Close</button>
      </div>
    </div>
    <div class="admin-body">
      <aside class="admin-list" id="adminList"></aside>
      <section class="admin-editor" id="adminEditor">
        <div class="empty-state">
          <p>Select a product to edit its images (2â€“5), title, price and specs.</p>
          <p class="tiny muted">Tip: Drag to reorder images. PNG/JPG only.</p>
        </div>
      </section>
    </div>
    <div class="admin-footer">
      <div class="settings">
        <label>Admin Password:</label>
        <input type="password" id="adminPasswordSetting" placeholder="Set new password" />
        <button id="savePassword" class="btn">Update Password</button>
      </div>
      <div class="numbers">
        <label>WhatsApp Numbers (comma-separated):</label>
        <input type="text" id="waNumbersSetting" placeholder="e.g., 0597053192,0596012229,0594438054" />
        <button id="saveNumbers" class="btn">Update Numbers</button>
      </div>
    </div>
  </div>

  <script>
    (function(){
      // Default WhatsApp numbers (editable in Admin). All messages are TEXT ONLY.
      const WA_DEFAULT_NUMBERS = ["0597053192","0596012229","0594438054"];
      const DEFAULT_PASSWORD = "admin";
      const MAX_PLACEHOLDERS = 30;

      const els = {
        grid: document.getElementById("grid"),
        year: document.getElementById("year"),
        darkToggle: document.getElementById("darkToggle"),
        brand: document.getElementById("brandLogo"),
        viewModal: document.getElementById("viewModal"),
        viewImg: document.getElementById("viewImg"),
        viewTitle: document.getElementById("viewTitle"),
        viewSpecs: document.getElementById("viewSpecs"),
        viewPrice: document.getElementById("viewPrice"),
        prevImg: document.getElementById("prevImg"),
        nextImg: document.getElementById("nextImg"),
        bookBtn: document.getElementById("bookBtn"),
        bookModal: document.getElementById("bookModal"),
        bookForm: document.getElementById("bookForm"),
        custName: document.getElementById("custName"),
        custLocation: document.getElementById("custLocation"),
        custContact: document.getElementById("custContact"),
        custProduct: document.getElementById("custProduct"),
        waNumberBooking: document.getElementById("waNumberBooking"),
        waNumberRequest: document.getElementById("waNumberRequest"),
        waNumberHostel: document.getElementById("waNumberHostel"),
        closeButtons: document.querySelectorAll(".modal-close"),
        requestForm: document.getElementById("requestForm"),
        hostelForm: document.getElementById("hostelForm"),
        adminLoginModal: document.getElementById("adminLoginModal"),
        adminLoginForm: document.getElementById("adminLoginForm"),
        adminPasswordInput: document.getElementById("adminPasswordInput"),
        adminPanel: document.getElementById("adminPanel"),
        adminList: document.getElementById("adminList"),
        adminEditor: document.getElementById("adminEditor"),
        addProduct: document.getElementById("addProduct"),
        saveAll: document.getElementById("saveAll"),
        exportData: document.getElementById("exportData"),
        closeAdmin: document.getElementById("closeAdmin"),
        adminPasswordSetting: document.getElementById("adminPasswordSetting"),
        savePassword: document.getElementById("savePassword"),
        waNumbersSetting: document.getElementById("waNumbersSetting"),
        saveNumbers: document.getElementById("saveNumbers"),
      };

      const $ = (sel, root=document)=>root.querySelector(sel);
      const $$ = (sel, root=document)=>Array.from(root.querySelectorAll(sel));
      const save = (k,v)=>localStorage.setItem(k, JSON.stringify(v));
      const load = (k, fallback)=>{ try{ const v = JSON.parse(localStorage.getItem(k)); return v ?? fallback; }catch{ return fallback; } };

      function normalizeNumber(n){
        // Convert GH numbers like 059xxxxxxx to 23359xxxxxxx
        let d = String(n||"").replace(/\\D/g,'');
        if (d.startsWith("0") && d.length === 10) return "233" + d.slice(1);
        if (d.startsWith("233") && d.length === 12) return d;
        return d;
      }
      function waHref(number, message){
        const encoded = encodeURIComponent(message);
        const to = normalizeNumber(number);
        return `https://wa.me/${to}?text=${encoded}`;
      }
      function openWhatsApp(number, message){
        const href = waHref(number, message);
        window.open(href, "_blank");
      }

      const DATA_KEY = "sneakylinksData";
      const THEME_KEY = "sneakylinksTheme";
      const PASSWORD_KEY = "sneakylinksAdminPw";
      const NUMBERS_KEY = "sneakylinksNumbers";

      const state = {
        data: load(DATA_KEY, null),
        theme: load(THEME_KEY, "dark"),
        view: { product:null, idx:0 },
        pw: load(PASSWORD_KEY, DEFAULT_PASSWORD),
        numbers: load(NUMBERS_KEY, WA_DEFAULT_NUMBERS),
      };

      function initData(){
        if (state.data) return;
        const placeholders = [];
        for (let i=0;i<MAX_PLACEHOLDERS;i++){
          placeholders.push({
            id: crypto.randomUUID(),
            title: `Product ${i+1}`,
            price: "",
            specs: "Add specs in admin",
            images: [],
            category: "devices"
          });
        }
        state.data = { products: placeholders };
        save(DATA_KEY, state.data);
      }

      function applyTheme(){
        if(state.theme === "light"){ document.documentElement.classList.add("light"); }
        else { document.documentElement.classList.remove("light"); }
      }
      function toggleTheme(){ state.theme = state.theme === "light" ? "dark" : "light"; save(THEME_KEY, state.theme); applyTheme(); }

      function formatCurrency(v){
        if(!v && v!==0) return "";
        if (isNaN(Number(String(v).replace(/[^\\d.]/g,'')))) return String(v);
        try{ return new Intl.NumberFormat(undefined,{style:'currency',currency:'GHS',maximumFractionDigits:0}).format(Number(v)); }
        catch{ return `${v} GHS`; }
      }

      function productCard(p){
        const thumb = p.images?.[0] ? `<img src="${p.images[0]}" alt="${p.title}">` :
          `<svg width="64" height="64" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M7 4h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2m0 2v12h10V6zm2 3h6v2H9zm0 4h6v2H9z"/></svg>`;
        const price = p.price ? formatCurrency(p.price) : "";
        return `<article class="card product" data-id="${p.id}" tabindex="0" role="button" aria-label="${p.title}">
          <div class="thumb">${thumb}</div>
          <div class="title">${p.title || "Untitled"}</div>
          <div class="specs">${p.specs || ""}</div>
          <div class="row">
            <span class="price">${price}</span>
            <button class="btn" data-action="view" data-id="${p.id}">View</button>
          </div>
        </article>`;
      }

      function renderGrid(){ els.grid.innerHTML = state.data.products.map(productCard).join(""); }

      function openModal(id){ document.getElementById(id).classList.remove("hidden"); }
      function closeModal(id){ document.getElementById(id).classList.add("hidden"); }
      els.closeButtons.forEach(btn=>btn.addEventListener("click", e=>{ closeModal(e.currentTarget.getAttribute("data-close")); }));
      window.addEventListener("keydown", e=>{ if (e.key === "Escape"){ ["viewModal","bookModal","adminLoginModal"].forEach(closeModal); }});

      function openView(productId){
        const p = state.data.products.find(x=>x.id===productId);
        if (!p) return;
        state.view.product = p; state.view.idx = 0;
        document.getElementById("viewTitle").textContent = p.title || "Product";
        document.getElementById("viewSpecs").textContent = p.specs || "";
        document.getElementById("viewPrice").textContent = p.price ? formatCurrency(p.price) : "";
        document.getElementById("viewImg").src = (p.images && p.images[0]) || "";
        openModal("viewModal");
      }
      function shiftImg(delta){
        const imgs = state.view.product?.images || [];
        if (!imgs.length) return;
        state.view.idx = (state.view.idx + delta + imgs.length) % imgs.length;
        document.getElementById("viewImg").src = imgs[state.view.idx];
      }
      document.getElementById("prevImg").addEventListener("click", ()=>shiftImg(-1));
      document.getElementById("nextImg").addEventListener("click", ()=>shiftImg(1));

      els.grid.addEventListener("click", e=>{
        const btn = e.target.closest("[data-action='view']");
        const card = e.target.closest(".product");
        if (btn){ openView(btn.dataset.id); }
        else if (card){ openView(card.dataset.id); }
      });
      els.grid.addEventListener("keydown", e=>{
        if (e.key === "Enter" || e.key === " "){
          const card = e.target.closest(".product"); if (card){ openView(card.dataset.id); }
        }
      });

      document.getElementById("bookBtn").addEventListener("click", ()=>{
        if (!state.view.product) return;
        document.getElementById("custProduct").value = state.view.product.title;
        openModal("bookModal");
      });

      function populateNumbers(){
        const options = ['<option value="__ALL__">All numbers</option>']
          .concat(state.numbers.map(n => `<option value="${n}">${n}</option>`))
          .join("");
        els.waNumberBooking.innerHTML = options;
        els.waNumberRequest.innerHTML = options;
        els.waNumberHostel.innerHTML = options;
      }

      function sendToSelection(selectEl, message){
        const val = selectEl.value;
        if (val === "__ALL__"){
          // open WhatsApp chat for each configured number (text-only). May open multiple tabs.
          state.numbers.forEach((n, i)=> setTimeout(()=>openWhatsApp(n, message), i*150));
        } else {
          openWhatsApp(val, message);
        }
      }

      els.bookForm.addEventListener("submit", e=>{
        e.preventDefault();
        const name = els.custName.value.trim();
        const loc = els.custLocation.value.trim();
        const contact = els.custContact.value.trim();
        const product = els.custProduct.value.trim();
        if(!name || !loc || !contact || !product){ return; }
        const msg = `SNEAKYLINKS BOOKING
Name: ${name}
Location: ${loc}
Contact: ${contact}
Product: ${product}`;
        sendToSelection(els.waNumberBooking, msg);
      });

      els.requestForm.addEventListener("submit", e=>{
        e.preventDefault();
        const name = $("#reqName").value.trim();
        const contact = $("#reqContact").value.trim();
        const prod = $("#reqProduct").value.trim();
        const notes = $("#reqNotes").value.trim();
        if(!name || !contact || !prod){ return; }
        const msg = `SNEAKYLINKS PRODUCT REQUEST
Name: ${name}
Contact: ${contact}
Requested: ${prod}
Notes: ${notes || "-"}`;
        sendToSelection(els.waNumberRequest, msg);
      });

      els.hostelForm.addEventListener("submit", e=>{
        e.preventDefault();
        const name = $("#hostelName").value.trim();
        const contact = $("#hostelContact").value.trim();
        const loc = $("#hostelLocation").value.trim();
        const budget = $("#hostelBudget").value.trim();
        if(!name || !contact || !loc){ return; }
        const msg = `SNEAKYLINKS HOSTEL BOOKING
Name: ${name}
Contact: ${contact}
Preferred Location: ${loc}
Budget: ${budget || "-"}`;
        sendToSelection(els.waNumberHostel, msg);
      });

      // 5x logo click -> admin login
      let clickCount = 0, clickTimer = null;
      els.brand.addEventListener("click", ()=>{
        clickCount++; clearTimeout(clickTimer); clickTimer = setTimeout(()=>{ clickCount = 0; }, 900);
        if (clickCount >= 5){ clickCount = 0; openModal("adminLoginModal"); els.adminPasswordInput.focus(); }
      });

      els.adminLoginForm.addEventListener("submit", e=>{
        e.preventDefault();
        const pw = els.adminPasswordInput.value;
        if (pw === state.pw){ closeModal("adminLoginModal"); openAdmin(); els.adminPasswordInput.value = ""; }
        else { alert("Incorrect password."); }
      });

      // Admin
      function openAdmin(){ els.adminPanel.classList.remove("hidden"); renderAdminList(); els.adminEditor.innerHTML = `<div class="empty-state"><p>Select a product to edit its images (2â€“5), title, price and specs.</p><p class="tiny muted">Tip: Drag to reorder images. PNG/JPG only.</p></div>`; els.adminPasswordSetting.value = ""; els.waNumbersSetting.value = state.numbers.join(","); }
      function closeAdmin(){ els.adminPanel.classList.add("hidden"); }
      els.closeAdmin.addEventListener("click", closeAdmin);

      function renderAdminList(){
        els.adminList.innerHTML = state.data.products.map((p,i)=>{
          const thumb = p.images?.[0] ? `<img src="${p.images[0]}" style="width:36px;height:36px;object-fit:cover;border-radius:8px" alt="">` : `<div style="width:36px;height:36px;border-radius:8px;background:#14161c"></div>`;
          return `<div class="item" data-id="${p.id}">${thumb}<div><div style="font-weight:700">${p.title || "Untitled"}</div><div class="tiny muted">#${i+1}</div></div></div>`;
        }).join("");
        $$(".admin-list .item", els.adminList).forEach(item=>{
          item.addEventListener("click", ()=>{
            $$(".admin-list .item", els.adminList).forEach(i=>i.classList.remove("active"));
            item.classList.add("active");
            const id = item.getAttribute("data-id");
            editProduct(id);
          });
        });
      }

      function editProduct(id){
        const p = state.data.products.find(x=>x.id===id);
        if (!p) return;
        els.adminEditor.innerHTML = `
          <div class="form">
            <div class="form-row">
              <label>Title</label>
              <input type="text" id="eTitle" value="${p.title||""}" />
            </div>
            <div class="form-row">
              <label>Price (GHS)</label>
              <input type="text" id="ePrice" value="${p.price||""}" />
            </div>
            <div class="form-row">
              <label>Specs / Description</label>
              <textarea id="eSpecs" rows="4">${p.specs||""}</textarea>
            </div>
            <div class="form-row">
              <label>Images (2â€“5)</label>
              <div class="image-row" id="imgRow">
                ${(p.images||[]).map((src,idx)=>`
                  <div class="image-cell" draggable="true" data-idx="${idx}">
                    <span class="delete" data-del="${idx}">âœ•</span>
                    <img src="${src}" alt="">
                    <span class="handle">drag</span>
                  </div>`).join("")}
                <label class="image-cell" id="adder" title="Add image">
                  <input type="file" accept="image/*" style="display:none">
                  <svg width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M11 11V6h2v5h5v2h-5v5h-2v-5H6v-2z"/></svg>
                </label>
              </div>
              <p class="tiny muted">Add 2â€“5 images. They are stored locally in your browser (no server needed).</p>
            </div>
            <div class="form-actions">
              <button class="btn primary" id="saveProduct">Save Product</button>
            </div>
          </div>
        `;

        const eTitle = $("#eTitle", els.adminEditor);
        const ePrice = $("#ePrice", els.adminEditor);
        const eSpecs = $("#eSpecs", els.adminEditor);
        const adderInput = $("#adder input", els.adminEditor);

        $("#adder", els.adminEditor).addEventListener("click", ()=>adderInput.click());
        adderInput.addEventListener("change", async (e)=>{
          const file = e.target.files[0];
          if (!file) return;
          if (!file.type.startsWith("image/")) return;
          const dataUrl = await toDataURL(file);
          p.images.push(dataUrl);
          editProduct(id);
        });

        $$(".delete", els.adminEditor).forEach(btn=>btn.addEventListener("click", ()=>{
          const idx = Number(btn.getAttribute("data-del"));
          p.images.splice(idx,1);
          editProduct(id);
        }));

        $$(".image-cell[draggable='true']", els.adminEditor).forEach(cell=>{
          cell.addEventListener("dragstart", (ev)=>{
            ev.dataTransfer.setData("text/plain", cell.getAttribute("data-idx"));
            cell.classList.add("dragging");
          });
          cell.addEventListener("dragend", ()=>cell.classList.remove("dragging"));
          cell.addEventListener("dragover", (ev)=>ev.preventDefault());
          cell.addEventListener("drop", (ev)=>{
            ev.preventDefault();
            const from = Number(ev.dataTransfer.getData("text/plain"));
            const to = Number(cell.getAttribute("data-idx"));
            if(from===to) return;
            const img = p.images.splice(from,1)[0];
            p.images.splice(to,0,img);
            editProduct(id);
          });
        });

        $("#saveProduct", els.adminEditor).addEventListener("click", ()=>{
          p.title = eTitle.value.trim() || "Untitled";
          p.price = ePrice.value.trim();
          p.specs = eSpecs.value.trim();
          save(DATA_KEY, state.data);
          renderGrid();
          renderAdminList();
          alert("Saved product.");
        });
      }

      function toDataURL(file){
        return new Promise((resolve,reject)=>{
          const reader = new FileReader();
          reader.onload = ()=>resolve(reader.result);
          reader.onerror = reject;
          reader.readAsDataURL(file);
        });
      }

      els.addProduct.addEventListener("click", ()=>{
        state.data.products.push({
          id: crypto.randomUUID(),
          title: "New Product",
          price: "",
          specs: "",
          images: [],
          category: "devices"
        });
        save(DATA_KEY, state.data);
        renderGrid();
        renderAdminList();
      });

      els.saveAll.addEventListener("click", ()=>{ save(DATA_KEY, state.data); alert("All changes saved."); });

      els.exportData.addEventListener("click", ()=>{
        const blob = new Blob([JSON.stringify(state.data,null,2)], {type:"application/json"});
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url; a.download = "sneakylinks-data.json";
        a.click();
        URL.revokeObjectURL(url);
      });

      els.savePassword.addEventListener("click", ()=>{
        const v = els.adminPasswordSetting.value.trim();
        if(!v){ alert("Enter a new password."); return; }
        state.pw = v; localStorage.setItem(PASSWORD_KEY, JSON.stringify(v));
        alert("Admin password updated.");
        els.adminPasswordSetting.value = "";
      });
      els.saveNumbers.addEventListener("click", ()=>{
        const v = els.waNumbersSetting.value.trim();
        if(!v){ alert("Enter numbers."); return; }
        let arr = v.split(",").map(s=>s.replace(/\\D/g,"")).filter(Boolean);
        if(!arr.length){ alert("No valid numbers."); return; }
        state.numbers = arr; localStorage.setItem(NUMBERS_KEY, JSON.stringify(arr));
        populateNumbers();
        alert("WhatsApp numbers updated.");
      });

      function init(){
        if (!load(NUMBERS_KEY, null)){
          // Seed default numbers on first run
          localStorage.setItem(NUMBERS_KEY, JSON.stringify(WA_DEFAULT_NUMBERS));
          state.numbers = WA_DEFAULT_NUMBERS.slice();
        }
        initData();
        document.getElementById("year").textContent = new Date().getFullYear();
        applyTheme();
        populateNumbers();
        renderGrid();
      }

      document.getElementById("darkToggle").addEventListener("click", toggleTheme);

      document.querySelectorAll("[id$='Modal']").forEach(m => {
        m.addEventListener("click", (e)=>{ if (e.target === m) m.classList.add("hidden"); });
      });

      init();
    })();
  </script>
</body>
</html>
